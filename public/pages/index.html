<!doctype html>
<html lang="it">
<script src="/assets/auth-guard.js"></script>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FisioPro</title>
</head>
<body>
  <script>
    (async function () {
      try {
        const data = (typeof window.fpAuthMe === "function")
          ? await window.fpAuthMe()
          : await (async () => {
              const r = await fetch("/api/auth-me", { credentials: "include" });
              return await r.json().catch(() => ({}));
            })();
        const role = (data?.user?.role || data?.session?.role || "").toString();
        if (role === "physio") location.replace("/agenda.html");
        else location.replace("/pages/front-office.html");
      } catch {
        location.replace("/");
      }
    })();
  </script>
</body>
</html>

